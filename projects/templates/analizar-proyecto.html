{% extends "base.html" %}

{% block title %}Analizar Proyecto (IA){% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="/static/css/analizar.css">
{% endblock %}

{% block content %}
<!-- Main Content -->
<main class="main-content" id="mainContent">
    <!--Información de la pestaña actual-->
    <div class="content-header">
        <h2>{% block module %}Análisis de Proyecto con IA{% endblock %}</h2>
        <div class="breadcrumb">
            <span>Inicio</span> / <span class="active">
                {% block current_page %}Analizar Proyecto (IA){% endblock %}
            </span>
        </div>
    </div>

    <!-- Formulario y Resultados -->
    <div class="analysis-container">
        <div class="non-field-errors">
            {{ form.non_field_errors }}
        </div>
        <!-- Formulario de Análisis -->
        <div class="form-section">
            <h3><i class="fas fa-edit"></i> Datos del Proyecto a Analizar</h3>
            <form id="analysisForm" method="POST" action="">
                {% csrf_token %}

                <div id="general-errors" class="alert alert-danger" style="display: none;"></div>
                <div id="non-field-errors" class="alert alert-danger" style="display: none;"></div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="id_project_name">{{ form.project_name.label}}</label>
                        {{form.project_name}}
                        <div class="field-error" id="project_name_error" style="display: none; color: red;">{{form.project_name.errors}}</div>
                    </div>

                    <div class="form-group">
                        <label for="id_project_type">{{form.project_type.label}}</label>
                        {{form.project_type}}
                        <div class="field-error" id="project_type_error" style="display: none; color: red;"></div>
                    </div>

                    <div class="form-group">
                        <label for="id_project_function">{{form.project_function.label}}</label>
                        {{form.project_function}}
                        <div class="field-error" id="project_function_error" style="display: none; color: red;"></div>
                    </div>

                    <div class="form-group">
                        <label for="id_estimate">{{form.estimate.label}}</label>
                        {{form.estimate}}
                        <div class="field-error" id="estimate_error" style="display: none; color: red;"></div>
                    </div>

                    <div class="form-group">
                        <label for="id_time">{{form.time.label}}</label>
                        {{form.time}}
                        <div class="field-error" id="time_error" style="display: none; color: red;"></div>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label for="projectDescription">{{form.project_description.label}}</label>
                    {{form.project_description}}
                    <p class="hint">Describe el proyecto con el mayor detalle posible para un análisis más preciso.</p>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" id="cancelBtn">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button type="submit" class="btn btn-analyze">
                        <i class="fas fa-brain"></i> Analizar con IA
                    </button>
                </div>
            </form>
        </div>

        <!-- Resultados del Análisis -->
        <div class="results-section" id="resultsSection" style="display: none;">
            <div class="results-header">
                <h3 class="result-title"></h3>
                <button class="btn btn-export" id="exportBtn">
                    <i class="fas fa-file-export"></i> Exportar Informe
                </button>
            </div>

            <div class="results-content" id="resultsContent"></div>
                
                <!-- Los resultados se cargarán aquí dinámicamente -->
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block extra_js %}
    <script src="/static/js/analizar.js"></script>
{% endblock %}